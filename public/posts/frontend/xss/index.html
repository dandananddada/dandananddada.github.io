<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.f650796158c30fae4d1f.css">code[class*=language-],pre[class*=language-]{font-family:Consolas,Menlo,Monaco,Andale Mono WT,Andale Mono,Lucida Console,Lucida Sans Typewriter,DejaVu Sans Mono,Bitstream Vera Sans Mono,Liberation Mono,Nimbus Mono L,Courier New,Courier,monospace;font-size:14px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;background:#f3f3f3;color:#6e6b5e}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{text-shadow:none;background:#e8e4cf}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#e8e4cf}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999580}.token.punctuation{color:#6e6b5e}.token.namespace{opacity:.7}.token.boolean,.token.number,.token.operator{color:#b65611}.token.property{color:#ae9513}.token.tag{color:#6684e1}.token.string{color:#1fad83}.token.selector{color:#b854d4}.token.attr-name{color:#b65611}.language-css .token.string,.style .token.string,.token.entity,.token.url{color:#1fad83}.token.attr-value,.token.control,.token.directive,.token.keyword,.token.unit{color:#60ac39}.token.atrule,.token.regex,.token.statement{color:#1fad83}.token.placeholder,.token.variable{color:#6684e1}.token.deleted{text-decoration:line-through}.token.inserted{border-bottom:1px dotted #20201d;text-decoration:none}.token.italic{font-style:italic}.token.bold,.token.important{font-weight:700}.token.important{color:#d73737}.token.entity{cursor:help}pre>code.highlight{outline:.4em solid #d73737;outline-offset:.4em}.line-numbers .line-numbers-rows{border-right-color:#e8e4cf}.line-numbers-rows>span:before{color:#a6a28c}.line-highlight{background:rgba(125,122,104,.2);background:-webkit-gradient(linear,left top,right top,color-stop(70%,rgba(125,122,104,.2)),to(rgba(125,122,104,0)));background:linear-gradient(90deg,rgba(125,122,104,.2) 70%,rgba(125,122,104,0))}blockquote,body,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,ol,p,pre,ul{margin:0;padding:0}body{font-family:Helvetica,Arial,sans-serif;font-size:16px;line-height:1.5;font-weight:300;color:#111;background-color:#fdfdfd;-webkit-text-size-adjust:100%}blockquote,dl,figure,h1,h2,h3,h4,h5,h6,ol,p,pre,ul{margin-bottom:15px}img{vertical-align:middle}figure>img{display:block}figcaption{font-size:14px}ol,ul{margin-left:30px}li>ol,li>ul{margin-bottom:0}h1,h2,h3,h4,h5,h6{font-weight:300}a{color:#010101;text-decoration:none}a:visited{color:#000}a:hover{color:#111;text-decoration:underline}blockquote{color:#828282;border-left:4px solid #e8e8e8;padding-left:15px;font-size:18px;letter-spacing:-1px;font-style:italic}blockquote>:last-child{margin-bottom:0}code,pre{font-size:15px;border:1px solid #e8e8e8;border-radius:3px;background-color:#eef}code{padding:1px 5px}pre{padding:8px 12px;overflow-x:scroll}pre>code{border:0;padding-right:0;padding-left:0}.wrapper{max-width:740px;margin-right:auto;margin-left:auto;padding-right:30px;padding-left:30px}@media screen and (max-width:800px){.wrapper{max-width:770px;padding-right:15px;padding-left:15px}}.footer-col-wrapper:after,.wrapper:after{content:"";display:table;clear:both}.icon>svg{display:inline-block;width:16px;height:16px;vertical-align:middle}.icon>svg path{fill:#828282}.site-header{border-top:5px solid #424242;border-bottom:1px solid #e8e8e8;min-height:56px;position:relative}.site-title{font-size:26px;line-height:56px;letter-spacing:-1px;margin-bottom:0;float:left}.site-title,.site-title:visited{color:#424242}.site-nav{float:right;line-height:56px}.site-nav .menu-icon{display:none}.site-nav .page-link{color:#111;line-height:1.5}.site-nav .page-link:not(:first-child){margin-left:20px}@media screen and (max-width:600px){.site-nav{position:absolute;top:9px;right:30px;background-color:#fdfdfd;border:1px solid #e8e8e8;border-radius:5px;text-align:right}.site-nav .menu-icon{display:block;float:right;width:36px;height:26px;line-height:0;padding-top:10px;text-align:center}.site-nav .menu-icon>svg{width:18px;height:15px}.site-nav .menu-icon>svg path{fill:#424242}.site-nav .trigger{clear:both;display:none}.site-nav:hover .trigger{display:block;padding-bottom:5px}.site-nav .page-link{display:block;padding:5px 10px}}.site-footer{border-top:1px solid #e8e8e8;padding:30px 0}.footer-heading{font-size:18px;margin-bottom:15px}.contact-list,.social-media-list{list-style:none;margin-left:0}.footer-col-wrapper{font-size:15px;color:#828282;margin-left:-15px}.footer-col{float:left;margin-bottom:15px;padding-left:15px}.footer-col-1{width:calc(35% - 15px)}.footer-col-2{width:calc(20% - 15px)}.footer-col-3{width:calc(45% - 15px)}@media screen and (max-width:800px){.footer-col-1,.footer-col-2{width:calc(50% - 15px)}.footer-col-3{width:calc(100% - 15px)}}@media screen and (max-width:600px){.footer-col{float:none;width:calc(100% - 15px)}}.page-content{padding:30px 0}.page-heading{font-size:20px}.post-list{margin-left:0;list-style:none}.post-list>li{margin:3em 0}.post{margin-bottom:2.666em;padding-bottom:1.333em;border-bottom:thin solid #f3f3f3}.post-meta{font-family:Merriweather,"PT Serif",Georgia,Times New Roman,serif;font-style:italic;font-size:1.25rem;color:#7a7a7a}.post-link{font-family:Lato,Helvetica Neue,Helvetica,sans-serif;font-weight:600;display:block;font-size:3.18rem;line-height:1.2;color:#333;margin-top:.125em;margin-bottom:.5em}.post-link:hover{text-decoration:none}.post-summary{font-size:1.25rem;line-height:1.8}.post-header{margin-bottom:30px}.post-title{font-size:42px;letter-spacing:-1px;line-height:1}@media screen and (max-width:800px){.post-title{font-size:36px}}.post-content{margin-bottom:30px}.post-content h2{font-size:32px}@media screen and (max-width:800px){.post-content h2{font-size:28px}}.post-content h3{font-size:26px}@media screen and (max-width:800px){.post-content h3{font-size:22px}}.post-content h4{font-size:20px}@media screen and (max-width:800px){.post-content h4{font-size:18px}}.pagination{font-family:Lato,Helvetica Neue,Helvetica,sans-serif;font-weight:300;display:block;font-size:1rem}.pagination .left{float:left}.pagination .left:hover{text-decoration:none}.pagination .right,.rss-subscribe{float:right}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em georgia,serif;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-family:georgia,serif;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt"}img{max-width:100%;padding:0;margin:0 0 1.45rem}h1{font-size:2.25rem}h1,h2{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{padding:0;margin:0 0 1.45rem}ol,ul{padding:0;margin:0 0 1.45rem 1.45rem;list-style-position:outside;list-style-image:none}dd,dl,figure,p{padding:0;margin:0 0 1.45rem}pre{margin:0 0 1.45rem;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}table{font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset,table{padding:0;margin:0 0 1.45rem}blockquote{padding:0;margin:0 1.45rem 1.45rem}form,iframe,noscript{padding:0;margin:0 0 1.45rem}hr{padding:0;margin:0 0 calc(1.45rem - 1px);background:rgba(0,0,0,.2);border:none;height:1px}address{padding:0;margin:0 0 1.45rem}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}.test233{background-color:red}</style><meta name="generator" content="Gatsby 2.15.19"/><title data-react-helmet="true"></title><style data-styled="" data-styled-version="4.2.0"></style><link rel="shortcut icon" href="/icons/icon-48x48.png?v=008654519ce705ac7bc44303a9014606"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=008654519ce705ac7bc44303a9014606"/><link as="script" rel="preload" href="/styles-425a03c8aa3fa1d18fb0.js"/><link as="script" rel="preload" href="/component---src-templates-blog-page-js-c6d29d218fa50c4d10d6.js"/><link as="script" rel="preload" href="/app-787d0aa68dada16ed12d.js"/><link as="script" rel="preload" href="/webpack-runtime-6daf9f31b9a7c42fdb95.js"/><link as="fetch" rel="preload" href="/page-data/posts/frontend/xss/page-data.json" crossorigin="anonymous"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div class="page-content"><div class="wrapper"><div class="post"><header class="post-header"><h1 class="post-title">XSS</h1><p class="post-meta">June 22, 2019</p></header><article class="post-content"><h3>Overview</h3>
<h4>What is XSS</h4>
<p>Cross-site scripting (XSS) is a code injection attack that allows an attacker to execute malicious JavaScript in another user's browser.</p>
<p>The attacker exploits a vulnerability in a website, in order to get the website to deliver the malicious JavaScript for the victim to visit.</p>
<h4>How the malicious JavaScript is injected</h4>
<p>In the example below, a simple server-side script is used to display the latest comment on a website:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">print <span class="token string">"&lt;html>"</span>
print <span class="token string">"Latest comment:"</span>
print database<span class="token punctuation">.</span>latestComment
print <span class="token string">"&lt;/html>"</span></code></pre></div>
<p>Since the user input is included directly, an attacker could submit this comment: "<script>...</script>". Any user visiting the page would now receive the following response:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>html<span class="token operator">></span>
Latest comment<span class="token punctuation">:</span>
<span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span></code></pre></div>
<p>When the user's browser loads the page, it will execute whatever JavaScript code is contained inside the <code class="language-text">&lt;script&gt;</code> tags. The attacker has now succeeded with his attack.</p>
<h4>What is malicious JavaScript?</h4>
<p>JavaScript runs in a very restricted environment that has extremely limited access to the user's files and operating system. It would be very unlikely to cause any damage to your computer.</p>
<p>However, the possibility of JavaScript being malicious becomes more clear when you consider the following facts:</p>
<ul>
<li>JavaScript has access to some of the user's sensitive information, such as cookies.</li>
<li>JavaScript can send HTTP requests with arbitrary content to arbitrary destinations by using XMLHttpRequest and other mechanisms.</li>
<li>JavaScript can make arbitrary modifications to the HTML of the current page by using DOM manipulation methods.</li>
</ul>
<h4>The consequences of malicious JavaScript</h4>
<p><strong>Cookie theft</strong></p>
<p>  The attacker can access the victim's cookies associated with the website using <code class="language-text">document.cookie</code>, send them to his own server, and use them to extract sensitive information like session IDs.</p>
<p><strong>Keylogging</strong></p>
<p>  The attacker can register a keyboard event listener using <code class="language-text">addEventListener</code> and then send all of the user's keystrokes to his own server, potentially recording sensitive information such as passwords and credit card numbers.</p>
<p><strong>Phishing</strong></p>
<p>  The attacker can insert a fake login form into the page using DOM manipulation, set the form's action attribute to target his own server, and then trick the user into submitting sensitive information.</p>
<h3>XSS Attacks</h3>
<h4>How attack works</h4>
<p><img src="https://excess-xss.com/persistent-xss.png"></p>
<h4>Types of XSS</h4>
<ul>
<li>Persistent XSS, where the malicious string originates from the website's database.</li>
<li>Reflected XSS, where the malicious string originates from the victim's request.</li>
<li>DOM-based XSS, where the vulnerability is in the client-side code rather than the server-side code.</li>
</ul>
<h4>Reflected XSS</h4>
<p>In a reflected XSS attack, the malicious string is part of the victim's request to the website.</p>
<p><img src="https://excess-xss.com/reflected-xss.png"></p>
<p><strong>How can reflected XSS succeed?</strong></p>
<p>At first, reflected XSS might seem harmless because it requires the victim himself to actually send a request containing a malicious string. As it turns out, there are at least two common ways of causing a victim to launch a reflected XSS attack against himself:</p>
<ol>
<li>If the user targets a specific individual, the attacker can send the malicious URL to the victim (using e-mail or instant messaging, for example) and trick him into visiting it.</li>
<li>If the user targets a large group of people, the attacker can publish a link to the malicious URL (on his own website or on a social network, for example) and wait for visitors to click it.</li>
</ol>
<h4>DOM-based XSS</h4>
<p><img src="https://excess-xss.com/dom-based-xss.png"></p>
<p><strong>What makes DOM-based XSS different</strong></p>
<ul>
<li>In traditional XSS, the malicious JavaScript is executed when the page is loaded, as part of the HTML sent by the server.</li>
<li>In DOM-based XSS, the malicious JavaScript is executed at some point after the page has loaded, as a result of the page's legitimate JavaScript treating user input in an unsafe way.</li>
</ul>
<h3>Preventing XSS</h3>
<p>Recall that an XSS attack is a type of code injection, In order to prevent this type of code injection, secure input handling is needed. For a web developer, there are two fundamentally different ways of performing secure input handling.</p>
<ul>
<li><strong>Encoding</strong>, which escapes the user input so that the browser interprets it only as data, not as code.</li>
<li><strong>Validation</strong>, which filters the user input so that the browser interprets it as code without malicious commands.</li>
</ul>
<h4>Input handling contexts</h4>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center"></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Application code</td>
<td align="center"><code class="language-text">&lt;input value=&quot;userInput&quot;&gt;</code></td>
</tr>
<tr>
<td align="center">Malicious string</td>
<td align="center"><code class="language-text">&quot;&gt;&lt;script&gt;...&lt;/script&gt;&lt;input value=&quot;</code></td>
</tr>
<tr>
<td align="center">Resulting code</td>
<td align="center"><code class="language-text">&lt;input value=&quot;&quot;&gt;&lt;script&gt;...&lt;/script&gt;&lt;input value=&quot;&quot;&gt;</code></td>
</tr>
</tbody>
</table>
<p>If the same input were inserted into another context, the closing delimiter would be different and injection would become possible. For this reason, secure input handling always needs to be tailored to the context where the user input will be inserted.</p>
<h4>Inbound/outbound input handling</h4>
<p>There is no easy way of determining when user input arrives which context it will eventually be inserted into, Relying on inbound input handling to prevent XSS is thus a very brittle solution that will be prone to errors.
Instead, outbound input handling should be your primary line of defense against XSS, because it can take into account the specific context that user input will be inserted into.</p>
<p>In most modern web applications, user input is handled by both server-side code and client-side code. In order to protect against all types of XSS, secure input handling must be performed in both the server-side code and the client-side code.</p>
<h4>Encoding</h4>
<p>Encoding is the act of escaping user input so that the browser interprets it only as data, not as code.</p>
<p><strong>Limitations of encoding</strong></p>
<p>Even with encoding, it will be possible to input malicious strings into some contexts.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>href <span class="token operator">=</span> userInput</code></pre></div>
<p>This in itself does not prevent the attacker from inserting a URL beginning with "javascript:". When the link is clicked, whatever JavaScript is embedded inside the URL will be executed.</p>
<h4>Validation</h4>
<p>Validation is the act of filtering user input so that all malicious parts of it are removed, without necessarily removing all code in it. One of the most recognizable types of validation in web development is <strong>allowing</strong> some HTML elements (such as <code class="language-text">&lt;em&gt;</code> and <code class="language-text">&lt;strong&gt;</code>) but <strong>disallowing</strong> others (such as <code class="language-text">&lt;script&gt;</code>).</p>
<p>There are two main characteristics of validation that differ between implementations:</p>
<ul>
<li>Classification strategy</li>
<li>Validation outcome</li>
</ul>
<h5>Classification strategy</h5>
<p><strong>Blacklisting</strong></p>
<p>If a string matches this pattern, it is then marked as invalid.</p>
<p>However, blacklisting has two major drawbacks:</p>
<ul>
<li>
<p><strong>Complexity</strong></p>
<p>Accurately describing the set of all possible malicious strings is usually a very complex task. </p>
</li>
<li>
<p><strong>Staleness</strong></p>
<p>Even if a perfect blacklist were developed, it would fail if a new feature allowing malicious use were added to the browser. </p>
</li>
</ul>
<p><strong>Whitelisting</strong></p>
<p>Whitelisting is essentially the opposite of blacklisting: instead of defining a forbidden pattern, a whitelist approach defines an allowed pattern and marks input as invalid if it does not match this pattern.</p>
<p>Compared to blacklisting, there are two major benefits of whitelisting:</p>
<ul>
<li>
<p><strong>Simplicity</strong></p>
<p>Accurately describing a set of safe strings is generally much easier than identifying the set of all malicious strings.</p>
</li>
<li>
<p><strong>Longevity</strong></p>
<p>Unlike a blacklist, a whitelist will generally not become obsolete when a new feature is added to the browser.</p>
</li>
</ul>
<h5>Validation outcome</h5>
<p>When input has been marked as invalid, one of two actions can be taken:</p>
<ul>
<li>
<p>Rejection
The input is simply rejected</p>
</li>
<li>
<p>Sanitisation
All invalid parts of the input are removed, and the remaining input is used normally by the website.</p>
</li>
</ul>
<h3>Which prevention technique to use</h3>
<p><strong>Encoding</strong> should be your first line of defense against XSS</p>
<p>As a second line of defense, you should use <strong>inbound validation</strong> to sanitize or reject data</p>
<p>As a third line of defense, you should also make use of <strong>Content Security Policy</strong> (CSP)</p>
<h3>Content Security Policy (CSP)</h3>
<p>CSP is used to constrain the browser viewing your page so that it can only use resources downloaded from trusted sources. </p>
<p>CSP can be used to enforce the following rules:</p>
<ul>
<li>
<p><strong>No untrusted sources</strong></p>
<p>External resources can only be loaded from a set of clearly defined trusted sources.</p>
</li>
<li>
<p><strong>No inline resources</strong></p>
<p>Inline JavaScript and CSS will not be evaluated.</p>
</li>
<li>
<p><strong>No eval</strong></p>
<p>The JavaScript eval function cannot be used.</p>
</li>
</ul>
<h4>How to enable CSP</h4>
<p>By default, browsers do not enforce CSP. To enable CSP on your website, pages must be served with an additional HTTP header: <code class="language-text">Content‑Security‑Policy</code>.</p>
<h4>An example policy</h4>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html">Content‑Security‑Policy:
    script‑src 'self' scripts.example.com;
    media‑src 'none';
    img‑src *;
    default‑src 'self' http://*.example.com</code></pre></div>
<ul>
<li>Scripts can be downloaded only from the host serving the page and from <code class="language-text">scripts.example.com</code>.</li>
<li>Audio and video files cannot be downloaded from anywhere.</li>
<li>Image files can be downloaded from any host.</li>
<li>All other resources can be downloaded only from the host serving the page and from any subdomain of <code class="language-text">example.com</code>.</li>
</ul>
<h4>Status of CSP</h4>
<p>As of June 2013, Content Security Policy is a W3C candidate recommendation. It is being implemented by browser vendors, but parts of it are still browser-specific.</p>
<h3>Summary</h3>
<h4>Overview of XSS</h4>
<ul>
<li>XSS is a code injection attack made possible through insecure handling of user input.</li>
<li>A successful XSS attack allows an attacker to execute malicious JavaScript in a victim's browser.</li>
<li>A successful XSS attack compromises the security of both the website and its users.</li>
</ul>
<h4>XSS Attacks</h4>
<ul>
<li>
<p>There are three major types of XSS attacks:</p>
<ul>
<li><strong>Persistent XSS</strong>, where the malicious input originates from the website's database.</li>
<li><strong>Reflected XSS</strong>, where the malicious input originates from the victim's request.</li>
<li><strong>DOM-based XSS</strong>, where the vulnerability is in the client-side code rather than the server-side code.</li>
</ul>
</li>
<li>All of these attacks are performed in different ways but have the same effect if they succeed.</li>
</ul>
<h4>Preventing XSS</h4>
<ul>
<li>
<p>The most important way of preventing XSS attacks is to perform secure input handling.</p>
<ul>
<li>Most of the time, encoding should be performed whenever user input is included in a page.</li>
<li>In some cases, encoding has to be replaced by or complemented with validation.</li>
<li>Secure input handling has to take into account which context of a page the user input is inserted into.</li>
<li>To prevent all types of XSS attacks, secure input handling has to be performed in both client-side and server-side code.</li>
</ul>
</li>
<li>Content Security Policy provides an additional layer of defense for when secure input handling fails.</li>
</ul></article></div></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/frontend/xss";window.webpackCompilationHash="ee41558ce839fc3bf124";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-787d0aa68dada16ed12d.js"],"component---src-templates-game-games-template-js":["/component---src-templates-game-games-template-js-1bca7c046aa40df19f69.js"],"component---src-templates-blog-contents-js":["/component---src-templates-blog-contents-js-07611dac7319329a60bb.js"],"component---src-templates-blog-page-js":["/component---src-templates-blog-page-js-c6d29d218fa50c4d10d6.js"],"component---src-pages-404-js":["/component---src-pages-404-js-e687a356228f679e2153.js"],"component---src-pages-games-2-2019-js":["/component---src-pages-games-2-2019-js-1627def4761b798445c6.js"],"component---src-pages-index-js":["/component---src-pages-index-js-82ecd4d7633f01475aa8.js"],"component---src-pages-page-2-js":["/component---src-pages-page-2-js-029aff9787891df8c50e.js"]};/*]]>*/</script><script src="/webpack-runtime-6daf9f31b9a7c42fdb95.js" async=""></script><script src="/app-787d0aa68dada16ed12d.js" async=""></script><script src="/component---src-templates-blog-page-js-c6d29d218fa50c4d10d6.js" async=""></script><script src="/styles-425a03c8aa3fa1d18fb0.js" async=""></script></body></html>