{"expireTime":9007200917962570000,"key":"transformer-remark-markdown-ast-bb7c37e87813b51fbb11e5d947059056-gatsby-remark-prismjs-","val":{"type":"root","children":[{"type":"paragraph","children":[{"type":"text","value":"bootstrap内置的js插件中有一个模态框模块modal，对于小型表单进行编辑的时候使用模态框是一个相对更合理的选择。这里说明下如何在rails中使用modal。","position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":84,"offset":83},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":84,"offset":83},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"【1】install boostrap","position":{"start":{"line":3,"column":1,"offset":85},"end":{"line":3,"column":20,"offset":104},"indent":[]}}],"position":{"start":{"line":3,"column":1,"offset":85},"end":{"line":3,"column":20,"offset":104},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"在Gemfiel中配置bootstrap插件","position":{"start":{"line":5,"column":1,"offset":106},"end":{"line":5,"column":23,"offset":128},"indent":[]}}],"position":{"start":{"line":5,"column":1,"offset":106},"end":{"line":5,"column":23,"offset":128},"indent":[]}},{"type":"html","lang":null,"value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">gem &quot;twitter-bootstrap-rails&quot;</code></pre></div>","position":{"start":{"line":7,"column":1,"offset":130},"end":{"line":7,"column":31,"offset":160},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"然后执行命令\n","position":{"start":{"line":8,"column":1,"offset":161},"end":{"line":9,"column":1,"offset":168},"indent":[1]}},{"type":"html","value":"<code class=\"language-text\">$ bundle install</code>","position":{"start":{"line":9,"column":1,"offset":168},"end":{"line":9,"column":19,"offset":186},"indent":[]}},{"type":"text","value":"\n这样bootstrap插件就安装成功了。\n在application.js中配置引入modal模块。","position":{"start":{"line":9,"column":19,"offset":186},"end":{"line":11,"column":29,"offset":236},"indent":[1,1]}}],"position":{"start":{"line":8,"column":1,"offset":161},"end":{"line":11,"column":29,"offset":236},"indent":[1,1,1]}},{"type":"html","lang":null,"value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">//= require twitter/bootstrap</code></pre></div>","position":{"start":{"line":13,"column":1,"offset":238},"end":{"line":15,"column":4,"offset":275},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"【2】modal for model create","position":{"start":{"line":17,"column":1,"offset":277},"end":{"line":17,"column":26,"offset":302},"indent":[]}}],"position":{"start":{"line":17,"column":1,"offset":277},"end":{"line":17,"column":26,"offset":302},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"首先在index.html.erb添加模态框框架。","position":{"start":{"line":19,"column":1,"offset":304},"end":{"line":19,"column":26,"offset":329},"indent":[]}}],"position":{"start":{"line":19,"column":1,"offset":304},"end":{"line":19,"column":26,"offset":329},"indent":[]}},{"type":"html","lang":"html","value":"<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>modal fade<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>myModal<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">tabindex</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>-1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">role</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>dialog<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">aria-labelledby</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>myModal<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">aria-hidden</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>modal-dialog<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>modal-content<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>","position":{"start":{"line":21,"column":1,"offset":331},"end":{"line":28,"column":4,"offset":541},"indent":[1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"添加新建按钮","position":{"start":{"line":29,"column":1,"offset":542},"end":{"line":29,"column":7,"offset":548},"indent":[]}}],"position":{"start":{"line":29,"column":1,"offset":542},"end":{"line":29,"column":7,"offset":548},"indent":[]}},{"type":"html","lang":"html","value":"<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>&lt;%= new_controller_name_path %><span class=\"token punctuation\">\"</span></span> \n   <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>btn btn-primary<span class=\"token punctuation\">\"</span></span> \n   <span class=\"token attr-name\">data-toggle</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>modal<span class=\"token punctuation\">\"</span></span> \n   <span class=\"token attr-name\">data-target</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>#myModal<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>create\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span></code></pre></div>","position":{"start":{"line":31,"column":1,"offset":550},"end":{"line":37,"column":4,"offset":694},"indent":[1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"但是这里要注意，默认情况下rails会渲染views/layouts下的模板，需要在controller中设置new方法的render layout为false。","position":{"start":{"line":38,"column":1,"offset":695},"end":{"line":38,"column":82,"offset":776},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":695},"end":{"line":38,"column":82,"offset":776},"indent":[]}},{"type":"html","lang":"ruby","value":"<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">new</span></span>\n  <span class=\"token variable\">@model</span> <span class=\"token operator\">=</span> <span class=\"token constant\">Model</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">new</span>\n  <span class=\"token class-name\">render</span> layout<span class=\"token punctuation\">:</span> <span class=\"token keyword\">false</span>\n<span class=\"token keyword\">end</span></code></pre></div>","position":{"start":{"line":40,"column":1,"offset":778},"end":{"line":45,"column":4,"offset":845},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"最后在","position":{"start":{"line":46,"column":1,"offset":846},"end":{"line":46,"column":4,"offset":849},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">new.html.erb</code>","position":{"start":{"line":46,"column":4,"offset":849},"end":{"line":46,"column":18,"offset":863},"indent":[]}},{"type":"text","value":"中加入modal主体。","position":{"start":{"line":46,"column":18,"offset":863},"end":{"line":46,"column":29,"offset":874},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":846},"end":{"line":46,"column":29,"offset":874},"indent":[]}},{"type":"html","lang":"html","value":"<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>modal-header<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>close<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">data-dismiss</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>modal<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">aria-hidden</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\t\t<span class=\"token entity\" title=\"&times;\">&amp;times;</span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h4</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>modal-title<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>myModalLabel<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Modal Title<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h4</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>modal-body<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\t&lt;%= render partial ... %>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>modal-footer<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>javascript:submit()<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>btn btn-primary<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Submit<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>btn btn-default<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">data-dismiss</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>modal<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Back<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>","position":{"start":{"line":48,"column":1,"offset":876},"end":{"line":62,"column":4,"offset":1297},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"【3】modal for edit model","position":{"start":{"line":64,"column":1,"offset":1299},"end":{"line":64,"column":24,"offset":1322},"indent":[]}}],"position":{"start":{"line":64,"column":1,"offset":1299},"end":{"line":64,"column":24,"offset":1322},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"修改部分针对每一条记录实例化出一个模态框，并分别调用。","position":{"start":{"line":66,"column":1,"offset":1324},"end":{"line":66,"column":28,"offset":1351},"indent":[]}}],"position":{"start":{"line":66,"column":1,"offset":1324},"end":{"line":66,"column":28,"offset":1351},"indent":[]}},{"type":"html","lang":"ruby","value":"<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\">  <span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span> <span class=\"token variable\">@models</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">each</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>model<span class=\"token operator\">|</span> <span class=\"token string\">%>\n    &lt;a href=\"&lt;%= edit_model_path(model) %></span>\"\n       <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"btn btn-primary\"</span> \n       data<span class=\"token operator\">-</span>toggle<span class=\"token operator\">=</span><span class=\"token string\">\"modal\"</span> \n       data<span class=\"token operator\">-</span>target<span class=\"token operator\">=</span><span class=\"token string\">\"#myModal_&lt;%= model.id %>\"</span><span class=\"token operator\">></span><span class=\"token constant\">Edit</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span>  \n    <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"modal fade\"</span> \n         id<span class=\"token operator\">=</span><span class=\"token string\">\"myModal_&lt;%= model.id %>\"</span> \n         tabindex<span class=\"token operator\">=</span><span class=\"token string\">\"-1\"</span> \n         role<span class=\"token operator\">=</span><span class=\"token string\">\"dialog\"</span> \n         aria<span class=\"token operator\">-</span>labelledby<span class=\"token operator\">=</span><span class=\"token string\">\"myModal\"</span> \n         aria<span class=\"token operator\">-</span>hidden<span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span><span class=\"token operator\">></span>\n         <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"modal-dialog\"</span><span class=\"token operator\">></span>\n              <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"modal-content\"</span><span class=\"token operator\">></span>\n                <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span> render form <span class=\"token operator\">--</span><span class=\"token operator\">></span>\n              <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n         <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span> <span class=\"token keyword\">end</span> dialog <span class=\"token operator\">--</span><span class=\"token operator\">></span>\n   <span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span> <span class=\"token keyword\">end</span> <span class=\"token operator\">%</span><span class=\"token operator\">></span></code></pre></div>","position":{"start":{"line":68,"column":1,"offset":1354},"end":{"line":88,"column":4,"offset":1939},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"controller中edit方法同样设置","position":{"start":{"line":89,"column":1,"offset":1940},"end":{"line":89,"column":22,"offset":1961},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">render layout: false</code>","position":{"start":{"line":89,"column":22,"offset":1961},"end":{"line":89,"column":44,"offset":1983},"indent":[]}},{"type":"text","value":"，对于增加和修改页表单相同的情况直接在","position":{"start":{"line":89,"column":44,"offset":1983},"end":{"line":89,"column":63,"offset":2002},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">new.html.erb</code>","position":{"start":{"line":89,"column":63,"offset":2002},"end":{"line":89,"column":77,"offset":2016},"indent":[]}},{"type":"text","value":"和","position":{"start":{"line":89,"column":77,"offset":2016},"end":{"line":89,"column":78,"offset":2017},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">edit.html.erb</code>","position":{"start":{"line":89,"column":78,"offset":2017},"end":{"line":89,"column":93,"offset":2032},"indent":[]}},{"type":"text","value":"中使用","position":{"start":{"line":89,"column":93,"offset":2032},"end":{"line":89,"column":96,"offset":2035},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">&lt;%= render &#39;form&#39; &#39;%&gt;</code>","position":{"start":{"line":89,"column":96,"offset":2035},"end":{"line":89,"column":119,"offset":2058},"indent":[]}},{"type":"text","value":"就可以，模态框主体内容在","position":{"start":{"line":89,"column":119,"offset":2058},"end":{"line":89,"column":131,"offset":2070},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">_form.html.erb</code>","position":{"start":{"line":89,"column":131,"offset":2070},"end":{"line":89,"column":147,"offset":2086},"indent":[]}},{"type":"text","value":"中定义即可。","position":{"start":{"line":89,"column":147,"offset":2086},"end":{"line":89,"column":153,"offset":2092},"indent":[]}}],"position":{"start":{"line":89,"column":1,"offset":1940},"end":{"line":89,"column":153,"offset":2092},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":89,"column":153,"offset":2092}}}}