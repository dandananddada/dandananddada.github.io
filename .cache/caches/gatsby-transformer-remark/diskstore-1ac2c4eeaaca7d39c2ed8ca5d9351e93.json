{"expireTime":9007200917962570000,"key":"transformer-remark-markdown-html-ast-3c7aa19ed5d9ed39d05ef324f89c0724-gatsby-remark-prismjs-","val":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"目前ckeditor本身是可以通过js直接配置的，也就是说无关后台语言，拷贝过来就可以直接使用。但是之所以还要通过第三方插件整合CKeditor是因为一般需要文本编辑的时候肯定会包含图片的，正常情况下图片上传是需要走后台的，而官方的CKfinder本身是要收费的，所以需要一个第三方插件将CKeditor和一个图片上传的功能整合起来，这里我采用的插件是galetahub的CKeidtor插件。","position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":198,"offset":197}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":198,"offset":197}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"【1】install CKeditor","position":{"start":{"line":3,"column":1,"offset":199},"end":{"line":3,"column":20,"offset":218}}}],"position":{"start":{"line":3,"column":1,"offset":199},"end":{"line":3,"column":20,"offset":218}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在Gemfile中配置CKeditor插件","position":{"start":{"line":5,"column":1,"offset":220},"end":{"line":5,"column":22,"offset":241}}}],"position":{"start":{"line":5,"column":1,"offset":220},"end":{"line":5,"column":22,"offset":241}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"> //Gemfile\ngem &quot;paperclip&quot;\ngem &#39;ckeditor&#39;\ngem &#39;responders&#39;</code></pre></div>","position":{"start":{"line":7,"column":1,"offset":243},"end":{"line":10,"column":18,"offset":305}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"这里需要引入三个插件，paperclip、ckeditor和responders,其中paperclip是一个图片上传插件，ckeditor就不多说了，responders提供了一些response模块可以简化代码，在ckeditor和paperclip衔接的模块需要依赖，所以也要安装。\n执行命令安装插件\n","position":{"start":{"line":11,"column":1,"offset":306},"end":{"line":13,"column":1,"offset":460}}},{"type":"raw","value":"<code class=\"language-text\">$ bundle install</code>","position":{"start":{"line":13,"column":1,"offset":460},"end":{"line":13,"column":19,"offset":478}}}],"position":{"start":{"line":11,"column":1,"offset":306},"end":{"line":13,"column":19,"offset":478}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"【2】Add table to your database","position":{"start":{"line":15,"column":1,"offset":480},"end":{"line":15,"column":30,"offset":509}}}],"position":{"start":{"line":15,"column":1,"offset":480},"end":{"line":15,"column":30,"offset":509}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"执行如下命令生成migration以及models文件\n","position":{"start":{"line":17,"column":1,"offset":511},"end":{"line":18,"column":1,"offset":539}}},{"type":"raw","value":"<code class=\"language-text\">rails g ckeditor:install --orm=active_record --backend=paperclip</code>","position":{"start":{"line":18,"column":1,"offset":539},"end":{"line":18,"column":67,"offset":605}}},{"type":"text","value":"\n命令成功后会在你的db/migration目录下生成一个ckeditor","position":{"start":{"line":18,"column":67,"offset":605},"end":{"line":19,"column":37,"offset":642}}},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"assets文件，执行\n","position":{"start":{"line":19,"column":38,"offset":643},"end":{"line":20,"column":1,"offset":655}}},{"type":"raw","value":"<code class=\"language-text\">$ rake db:migrate</code>","position":{"start":{"line":20,"column":1,"offset":655},"end":{"line":20,"column":20,"offset":674}}},{"type":"text","value":"\n自动化建立ckeditor","position":{"start":{"line":20,"column":20,"offset":674},"end":{"line":21,"column":16,"offset":690}}}],"position":{"start":{"line":19,"column":37,"offset":642},"end":{"line":21,"column":17,"offset":691}}},{"type":"text","value":"assets表，这个表是用来存储你再进行文本编辑时上传的图片的。\n之前的命令，除了生成migration文件外还会在models目录下创建一个ckeditor目录，目录下会有三个实体，查看可以发现一个是asset实体，另外两个分别是文件和图片的实体，大体可以知道这个是ckeditor插件用来自动维护上传的图片和文件所需的models，你可以修改has","position":{"start":{"line":21,"column":17,"offset":691},"end":{"line":22,"column":146,"offset":869}}},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"attached","position":{"start":{"line":22,"column":147,"offset":870},"end":{"line":22,"column":155,"offset":878}}}],"position":{"start":{"line":22,"column":146,"offset":869},"end":{"line":22,"column":156,"offset":879}}},{"type":"text","value":"file 来定义文件存放的路径，默认情况下是存放在public/ckeditor_assets目录下的。\n到目前为止初始化工作就差不多了。","position":{"start":{"line":22,"column":156,"offset":879},"end":{"line":23,"column":17,"offset":948}}}],"position":{"start":{"line":17,"column":1,"offset":511},"end":{"line":23,"column":17,"offset":948}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"【3】final work","position":{"start":{"line":25,"column":1,"offset":950},"end":{"line":25,"column":14,"offset":963}}}],"position":{"start":{"line":25,"column":1,"offset":950},"end":{"line":25,"column":14,"offset":963}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"接下来做一些资源文件的配置。\n首先创建我们将会用到的一些js文件，在app/assets/javascripts目录下创建ckeditor文件夹并创建一个config.js文件（这里config.js文件有点长不方便阅读，完整的代码我就放在最后的附录里了。）","position":{"start":{"line":27,"column":1,"offset":965},"end":{"line":28,"column":115,"offset":1094}}}],"position":{"start":{"line":27,"column":1,"offset":965},"end":{"line":28,"column":115,"offset":1094}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CKEDITOR</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token constant\">CKEDITOR</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">editorConfig</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">config</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> \n\t\t<span class=\"token comment\">//... some config here</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":30,"column":1,"offset":1096},"end":{"line":36,"column":4,"offset":1231}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"之后在application.js中引入这个文件，同时引入ckeditor的初始化文件","position":{"start":{"line":38,"column":1,"offset":1233},"end":{"line":38,"column":44,"offset":1276}}}],"position":{"start":{"line":38,"column":1,"offset":1233},"end":{"line":38,"column":44,"offset":1276}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">//= require ckeditor/init\n//= require ckeditor/config</code></pre></div>","position":{"start":{"line":39,"column":1,"offset":1277},"end":{"line":42,"column":4,"offset":1338}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"采用这种方式的话就不需要在application.html.erb中引入ckeditor.js并写初始化js代码了。\n这个时候可以在_form中使用ckeditor了。","position":{"start":{"line":43,"column":1,"offset":1339},"end":{"line":44,"column":26,"offset":1423}}}],"position":{"start":{"line":43,"column":1,"offset":1339},"end":{"line":44,"column":26,"offset":1423}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token operator\">&lt;</span><span class=\"token string\">%= f.cktext_area :content, :class =</span><span class=\"token operator\">></span> <span class=\"token string\">'class_name'</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:ckeditor</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token symbol\">:language</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">'zh-cn'</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:toolbar</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">'Full'</span> <span class=\"token punctuation\">}</span> </code></pre></div>","position":{"start":{"line":46,"column":1,"offset":1425},"end":{"line":48,"column":4,"offset":1546}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"这里你可以用symbol配置语言和工具栏，你也可以用config.js默认配置的选项。\n这样你就可以用ckeditor进行编辑并存储为html代码了，最后说明下显示的时候如何将html代码渲染成图文到页面","position":{"start":{"line":49,"column":1,"offset":1547},"end":{"line":50,"column":59,"offset":1649}}}],"position":{"start":{"line":49,"column":1,"offset":1547},"end":{"line":50,"column":59,"offset":1649}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"rails\"><pre class=\"language-rails\"><code class=\"language-rails\"> &lt;%= raw(@message.content) %&gt;</code></pre></div>","position":{"start":{"line":51,"column":1,"offset":1650},"end":{"line":53,"column":4,"offset":1692}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在你要显示的内容前用raw方法转换下就ok了。","position":{"start":{"line":54,"column":1,"offset":1693},"end":{"line":54,"column":24,"offset":1716}}}],"position":{"start":{"line":54,"column":1,"offset":1693},"end":{"line":54,"column":24,"offset":1716}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"【4】附录","position":{"start":{"line":56,"column":1,"offset":1718},"end":{"line":56,"column":6,"offset":1723}}}],"position":{"start":{"line":56,"column":1,"offset":1718},"end":{"line":56,"column":6,"offset":1723}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{},"children":[{"type":"text","value":"app/assets/javascript/ckeditor/config.js","position":{"start":{"line":58,"column":5,"offset":1729},"end":{"line":58,"column":45,"offset":1769}}}],"position":{"start":{"line":58,"column":1,"offset":1725},"end":{"line":58,"column":45,"offset":1769}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/*\nCopyright (c) 2003-2011, CKSource - Frederico Knabben. All rights reserved.\nFor licensing, see LICENSE.html or http://ckeditor.com/license\n*/</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CKEDITOR</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token constant\">CKEDITOR</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">editorConfig</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">config</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Define changes to default configuration here. For example:</span>\n        config<span class=\"token punctuation\">.</span>language <span class=\"token operator\">=</span> <span class=\"token string\">'zh-cn'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// config.uiColor = '#AADC6E';</span>\n        <span class=\"token comment\">/* Filebrowser routes */</span>\n        <span class=\"token comment\">// The location of an external file browser, that should be launched when \"Browse Server\" button is pressed.</span>\n        config<span class=\"token punctuation\">.</span>filebrowserBrowseUrl <span class=\"token operator\">=</span> <span class=\"token string\">\"/ckeditor/attachment_files\"</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// The location of an external file browser, that should be launched when \"Browse Server\" button is pressed in the Flash dialog.</span>\n        config<span class=\"token punctuation\">.</span>filebrowserFlashBrowseUrl <span class=\"token operator\">=</span> <span class=\"token string\">\"/ckeditor/attachment_files\"</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// The location of a script that handles file uploads in the Flash dialog.</span>\n        config<span class=\"token punctuation\">.</span>filebrowserFlashUploadUrl <span class=\"token operator\">=</span> <span class=\"token string\">\"/ckeditor/attachment_files\"</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// The location of an external file browser, that should be launched when \"Browse Server\" button is pressed in the Link tab of Image dialog.</span>\n        config<span class=\"token punctuation\">.</span>filebrowserImageBrowseLinkUrl <span class=\"token operator\">=</span> <span class=\"token string\">\"/ckeditor/pictures\"</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// The location of an external file browser, that should be launched when \"Browse Server\" button is pressed in the Image dialog.</span>\n        config<span class=\"token punctuation\">.</span>filebrowserImageBrowseUrl <span class=\"token operator\">=</span> <span class=\"token string\">\"/ckeditor/pictures\"</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// The location of a script that handles file uploads in the Image dialog.</span>\n        config<span class=\"token punctuation\">.</span>filebrowserImageUploadUrl <span class=\"token operator\">=</span> <span class=\"token string\">\"/ckeditor/pictures\"</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// The location of a script that handles file uploads.</span>\n        config<span class=\"token punctuation\">.</span>filebrowserUploadUrl <span class=\"token operator\">=</span> <span class=\"token string\">\"/ckeditor/attachment_files\"</span><span class=\"token punctuation\">;</span>\n\n        config<span class=\"token punctuation\">.</span>allowedContent <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Rails CSRF token</span>\n        config<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">filebrowserParams</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">var</span> csrf_token<span class=\"token punctuation\">,</span> csrf_param<span class=\"token punctuation\">,</span> meta<span class=\"token punctuation\">,</span> metas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByTagName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'meta'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            params <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> metas<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                meta <span class=\"token operator\">=</span> metas<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>meta<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">case</span> <span class=\"token string\">\"csrf-token\"</span><span class=\"token punctuation\">:</span>\n                    csrf_token <span class=\"token operator\">=</span> meta<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">case</span> <span class=\"token string\">\"csrf-param\"</span><span class=\"token punctuation\">:</span>\n                    csrf_param <span class=\"token operator\">=</span> meta<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>csrf_param <span class=\"token operator\">!==</span> <span class=\"token keyword\">undefined</span> <span class=\"token operator\">&amp;&amp;</span> csrf_token <span class=\"token operator\">!==</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                params<span class=\"token punctuation\">[</span>csrf_param<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> csrf_token<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\n            <span class=\"token keyword\">return</span> params<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n        config<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">addQueryString</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">url<span class=\"token punctuation\">,</span> params</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">var</span> queryString <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>params<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">return</span> url<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token keyword\">in</span> params<span class=\"token punctuation\">)</span> queryString<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token string\">\"=\"</span> <span class=\"token operator\">+</span> <span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\n            <span class=\"token keyword\">return</span> url <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"?\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"&amp;\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"?\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> queryString<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&amp;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Integrate Rails CSRF token into file upload dialogs (link, image, attachment and flash)</span>\n        <span class=\"token constant\">CKEDITOR</span><span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dialogDefinition'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">ev</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// Take the dialog name and its definition from the event data.</span>\n            <span class=\"token keyword\">var</span> dialogName <span class=\"token operator\">=</span> ev<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">var</span> dialogDefinition <span class=\"token operator\">=</span> ev<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>definition<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">var</span> content<span class=\"token punctuation\">,</span> upload<span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">CKEDITOR</span><span class=\"token punctuation\">.</span>tools<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'link'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'image'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'attachment'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'flash'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> dialogName<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                content <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>dialogDefinition<span class=\"token punctuation\">.</span><span class=\"token function\">getContents</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Upload'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> dialogDefinition<span class=\"token punctuation\">.</span><span class=\"token function\">getContents</span><span class=\"token punctuation\">(</span><span class=\"token string\">'upload'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                upload <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>content <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">:</span> content<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'upload'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>upload <span class=\"token operator\">&amp;&amp;</span> upload<span class=\"token punctuation\">.</span>filebrowser <span class=\"token operator\">&amp;&amp;</span> upload<span class=\"token punctuation\">.</span>filebrowser<span class=\"token punctuation\">[</span><span class=\"token string\">'params'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    upload<span class=\"token punctuation\">.</span>filebrowser<span class=\"token punctuation\">[</span><span class=\"token string\">'params'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> config<span class=\"token punctuation\">.</span><span class=\"token function\">filebrowserParams</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    upload<span class=\"token punctuation\">.</span>action <span class=\"token operator\">=</span> config<span class=\"token punctuation\">.</span><span class=\"token function\">addQueryString</span><span class=\"token punctuation\">(</span>upload<span class=\"token punctuation\">.</span>action<span class=\"token punctuation\">,</span> upload<span class=\"token punctuation\">.</span>filebrowser<span class=\"token punctuation\">[</span><span class=\"token string\">'params'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Toolbar groups configuration.</span>\n        config<span class=\"token punctuation\">.</span>toolbar <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n            name<span class=\"token punctuation\">:</span> <span class=\"token string\">'document'</span><span class=\"token punctuation\">,</span>\n            groups<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'mode'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'document'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'doctools'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            items<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Source'</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            name<span class=\"token punctuation\">:</span> <span class=\"token string\">'clipboard'</span><span class=\"token punctuation\">,</span>\n            groups<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'clipboard'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'undo'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            items<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Cut'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Copy'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Paste'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'PasteText'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'PasteFromWord'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Undo'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Redo'</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token comment\">// { name: 'editing', groups: [ 'find', 'selection', 'spellchecker' ], items: [ 'Find', 'Replace', '-', 'SelectAll', '-', 'Scayt' ] },</span>\n        <span class=\"token comment\">// { name: 'forms', items: [ 'Form', 'Checkbox', 'Radio', 'TextField', 'Textarea', 'Select', 'Button', 'ImageButton', 'HiddenField' ] },</span>\n        <span class=\"token punctuation\">{</span>\n            name<span class=\"token punctuation\">:</span> <span class=\"token string\">'links'</span><span class=\"token punctuation\">,</span>\n            items<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Link'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Unlink'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Anchor'</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            name<span class=\"token punctuation\">:</span> <span class=\"token string\">'insert'</span><span class=\"token punctuation\">,</span>\n            items<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Image'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Flash'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Table'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'HorizontalRule'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'SpecialChar'</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            name<span class=\"token punctuation\">:</span> <span class=\"token string\">'paragraph'</span><span class=\"token punctuation\">,</span>\n            groups<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'list'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'indent'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'blocks'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'align'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bidi'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            items<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'NumberedList'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'BulletedList'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Outdent'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Indent'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Blockquote'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'CreateDiv'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'JustifyLeft'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'JustifyCenter'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'JustifyRight'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'JustifyBlock'</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n            name<span class=\"token punctuation\">:</span> <span class=\"token string\">'styles'</span><span class=\"token punctuation\">,</span>\n            items<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Styles'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Format'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Font'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'FontSize'</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            name<span class=\"token punctuation\">:</span> <span class=\"token string\">'colors'</span><span class=\"token punctuation\">,</span>\n            items<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'TextColor'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'BGColor'</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            name<span class=\"token punctuation\">:</span> <span class=\"token string\">'basicstyles'</span><span class=\"token punctuation\">,</span>\n            groups<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'basicstyles'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'cleanup'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            items<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Bold'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Italic'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Underline'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Strike'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Subscript'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Superscript'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'RemoveFormat'</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n        config<span class=\"token punctuation\">.</span>toolbar_mini <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n            name<span class=\"token punctuation\">:</span> <span class=\"token string\">'paragraph'</span><span class=\"token punctuation\">,</span>\n            groups<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'list'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'indent'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'blocks'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'align'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bidi'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            items<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'NumberedList'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'BulletedList'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Outdent'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Indent'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Blockquote'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'CreateDiv'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'JustifyLeft'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'JustifyCenter'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'JustifyRight'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'JustifyBlock'</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            name<span class=\"token punctuation\">:</span> <span class=\"token string\">'styles'</span><span class=\"token punctuation\">,</span>\n            items<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Font'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'FontSize'</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            name<span class=\"token punctuation\">:</span> <span class=\"token string\">'colors'</span><span class=\"token punctuation\">,</span>\n            items<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'TextColor'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'BGColor'</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            name<span class=\"token punctuation\">:</span> <span class=\"token string\">'basicstyles'</span><span class=\"token punctuation\">,</span>\n            groups<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'basicstyles'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'cleanup'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            items<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Bold'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Italic'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Underline'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Strike'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Subscript'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Superscript'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'RemoveFormat'</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            name<span class=\"token punctuation\">:</span> <span class=\"token string\">'insert'</span><span class=\"token punctuation\">,</span>\n            items<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Image'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Table'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'HorizontalRule'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'SpecialChar'</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":60,"column":1,"offset":1771},"end":{"line":216,"column":4,"offset":8124}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":216,"column":4,"offset":8124}}}}